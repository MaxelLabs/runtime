# RHI Demo å¼€å‘æŒ‡å—

æœ¬æ–‡æ¡£æ˜¯ RHI Demo ç³»ç»Ÿçš„ç»¼åˆè°ƒç ”æŠ¥å‘Šå’Œå¼€å‘æŒ‡å—ã€‚

## æœ€è¿‘æ›´æ–°

### 2025-12-15 å®Œæˆç¬¬ä¸‰å±‚å…‰ç…§ç³»ç»Ÿ 3 ä¸ªå…‰æº Demo

**3 ä¸ªå…‰æºç±»å‹ Demo å·²å…¨éƒ¨å®Œæˆ**ï¼š

- **directional-light**: å¹³è¡Œå…‰æ¼”ç¤ºï¼Œå±•ç¤ºæ— ä½ç½®ã€æ— è¡°å‡çš„å¹³è¡Œå…‰ç…§æ•ˆæœï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`llmdoc/reference/directional-light-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šæ–¹å‘å‘é‡ã€Lambert æ¼«åå°„ã€Phong é•œé¢åå°„ã€std140 å¯¹é½

- **point-lights**: å¤šç‚¹å…‰æºæ¼”ç¤ºï¼Œæ”¯æŒæœ€å¤š 4 ä¸ªç‚¹å…‰æºåŒæ—¶å·¥ä½œï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`llmdoc/reference/point-lights-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šè·ç¦»è¡°å‡å…¬å¼ã€å¤šå…‰æºç´¯åŠ ã€ç‹¬ç«‹é¢œè‰²å’Œè¡°å‡å‚æ•°ã€208å­—èŠ‚ Uniform Buffer

- **spotlight**: èšå…‰ç¯æ¼”ç¤ºï¼Œå±•ç¤ºé”¥å½¢å…‰æŸå’Œå¹³æ»‘è¾¹ç¼˜è¿‡æ¸¡ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`llmdoc/reference/spotlight-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šä½ç½®+æ–¹å‘å‘é‡ã€å†…å¤–é”¥è§’ã€è§’åº¦è½¬ä½™å¼¦ã€è·ç¦»è¡°å‡ã€è¾¹ç¼˜å¹³æ»‘

**ä»£ç è´¨é‡æå‡**ï¼š
- Critic å®¡æŸ¥å‘ç°å¹¶ä¿®å¤äº† API ä¸ä¸€è‡´é—®é¢˜
- ç»Ÿä¸€æ‰€æœ‰å…‰æº Demo ä½¿ç”¨ `@maxellabs/core` API
- æ ‡å‡†åŒ– HTML æ–‡ä»¶ï¼ˆç§»é™¤å†…åµŒæ ·å¼ã€ç»Ÿä¸€è¯­è¨€ä¸º zh-CNï¼‰
- æ·»åŠ å®Œæ•´çš„é”®ç›˜äº‹ä»¶å¤„ç†ï¼ˆESC/F11/Rï¼‰
- æ‰€æœ‰èµ„æºä½¿ç”¨ `runner.track()` è¿½è¸ª

**æˆ˜ç•¥æ–‡æ¡£**ï¼š
- åˆ›å»º `llmdoc/agent/strategy-light-sources-campaign.md` è¯¦ç»†è§„åˆ’
- ä½¿ç”¨ Campaign Mode å¹¶è¡Œå¼€å‘ 3 ä¸ª Demo
- å®Œæ•´çš„ Constitution åˆè§„æ€§æ£€æŸ¥

### 2025-12-13 å®Œæˆç¬¬äºŒå±‚çº¹ç†ç³»ç»Ÿå…¨éƒ¨ Demo

**5 ä¸ªçº¹ç†ç³»ç»Ÿé«˜çº§ Demo å·²å…¨éƒ¨å®Œæˆ**ï¼š

- **cubemap-skybox**: ç«‹æ–¹ä½“è´´å›¾å¤©ç©ºç›’æ¼”ç¤ºï¼Œå±•ç¤ºå¤©ç©ºæ¸å˜ç”Ÿæˆå’Œåå°„ç¯å¢ƒæ˜ å°„ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/cubemap-skybox-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šCubemapGeneratorã€å¤©ç©ºæ¸å˜ã€ç¯å¢ƒæ˜ å°„ã€MVPçŸ©é˜µå˜æ¢

- **render-to-texture**: æ¸²æŸ“åˆ°çº¹ç†æ¼”ç¤ºï¼Œå±•ç¤ºç¦»å±æ¸²æŸ“å’ŒåæœŸå¤„ç†åŸºç¡€ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/render-to-texture-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šRenderTargetã€ç¦»å±æ¸²æŸ“ã€çº¹ç†é‡‡æ ·ã€FBOç®¡ç†

- **texture-array**: çº¹ç†æ•°ç»„æ¼”ç¤ºï¼Œå±•ç¤ºWebGL2çš„TEXTURE_2D_ARRAYæ”¯æŒï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/texture-array-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šTEXTURE_2D_ARRAYã€å±‚çº§é€‰æ‹©ã€æ‰¹é‡çº¹ç†ç®¡ç†

- **compressed-texture**: å‹ç¼©çº¹ç†æ¼”ç¤ºï¼Œå±•ç¤ºKTX/DDSæ ¼å¼åŠ è½½ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/compressed-texture-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šKTX/DDSæ ¼å¼ã€å‹ç¼©çº¹ç†æ£€æµ‹ã€GPUå†…å­˜ä¼˜åŒ–

- **procedural-texture**: ç¨‹åºåŒ–çº¹ç†ç”Ÿæˆæ¼”ç¤ºï¼Œå±•ç¤ºå¤šç§ç®—æ³•çº¹ç†ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/procedural-texture-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šPerlinå™ªå£°ã€åˆ†å½¢å¸ƒæœ—è¿åŠ¨ã€æ³¢å½¢å‡½æ•°ã€æ¸å˜ç®—æ³•

**ä»£ç æ›´æ–°**ï¼š
- `packages/rhi/src/webgl/resources/GLTexture.ts`: æ·»åŠ  TEXTURE_2D_ARRAY æ”¯æŒ
- `packages/rhi/demo/index.html`: æ·»åŠ  5 ä¸ª Demo å¯¼èˆªå¡ç‰‡

### 2025-12-12 å®Œæˆå¤šçº¹ç† Demo

- **multi-textures**: å¤šçº¹ç†ç»‘å®šå’Œæ··åˆæ¨¡å¼æ¼”ç¤ºï¼Œå±•ç¤º5ç§æ··åˆæ¨¡å¼ï¼ˆLinear/Multiply/Screen/Overlay/Maskï¼‰å’Œç¨‹åºåŒ–çº¹ç†ç”Ÿæˆï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/multi-textures-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šå¤šçº¹ç†ç»‘å®šã€Uniformå—æ§åˆ¶ã€ç¨‹åºåŒ–çº¹ç†ã€é®ç½©æ··åˆã€å®æ—¶å‚æ•°è°ƒèŠ‚

### 2025-12-12 å®Œæˆ Mipmap Demo

- **mipmaps**: Mipmap ç”Ÿæˆå’Œä½¿ç”¨æ¼”ç¤ºï¼Œå±•ç¤ºè‡ªåŠ¨ç”Ÿæˆã€æ‰‹åŠ¨ LOD æ§åˆ¶å’Œä¸‰ç§è¿‡æ»¤æ¨¡å¼ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/mipmaps-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼štextureLodã€generateMipmapsã€LINEAR_MIPMAP_LINEARã€LOD çº§åˆ«å¯è§†åŒ–

### 2025-12-12 å®Œæˆçº¹ç†åŒ…è£¹æ¨¡å¼ Demo

ç¬¬äºŒå±‚çº¹ç†ç³»ç»Ÿ Demo ç»§ç»­å¼€å‘ï¼š

- **texture-wrapping**: çº¹ç†åŒ…è£¹æ¨¡å¼æ¼”ç¤ºï¼Œå±•ç¤º 3 ç§åŒ…è£¹æ¨¡å¼çš„è§†è§‰æ•ˆæœå·®å¼‚ï¼ˆå·²å®Œæˆï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/texture-wrapping-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šREPEAT/MIRROR_REPEAT/CLAMP_TO_EDGEã€addressModeã€UV è¶…å‡ºèŒƒå›´å¤„ç†

### 2025-12-12 å®Œæˆçº¹ç†è¿‡æ»¤ Demo

- **texture-filtering**: çº¹ç†è¿‡æ»¤æ¨¡å¼æ¼”ç¤ºï¼Œå±•ç¤º 6 ç§è¿‡æ»¤æ¨¡å¼çš„è§†è§‰æ•ˆæœå·®å¼‚
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/texture-filtering-demo.md`ï¼ˆå·²åˆ›å»ºï¼‰
  - æŠ€æœ¯è¦ç‚¹ï¼šNEAREST/LINEAR/BILINEAR/TRILINEAR/å„å‘å¼‚æ€§è¿‡æ»¤ã€Mipmap é‡‡æ ·ã€å€¾æ–œå¹³é¢å±•ç¤º

### 2025-12-12 æ–‡æ¡£åŒæ­¥å®Œæˆ

**æ–‡æ¡£åŒæ­¥å®Œæˆ**ï¼š
- åˆ›å»º 3 ä¸ªçº¹ç†ç³»ç»Ÿ Demo å‚è€ƒæ–‡æ¡£ï¼štexture-filtering-demo.mdã€texture-wrapping-demo.mdã€mipmaps-demo.md
- æ›´æ–° `/llmdoc/index.md` æ·»åŠ æ–° Demo æ–‡æ¡£ç´¢å¼•
- ä¿®æ­£ demo-development.md ä¸­ Demo å®ŒæˆçŠ¶æ€æ ‡è®°ï¼ˆä»"å¾…åˆ›å»º"æ”¹ä¸º"å·²åˆ›å»º"ï¼‰
- æ‰€æœ‰æ–‡æ¡£ä¸ä»£ç å®ç°ä¿æŒåŒæ­¥ï¼Œç¡®ä¿ LLM æ£€ç´¢åœ°å›¾å‡†ç¡®æ€§

### 2025-12-11 å¼€å§‹ç¬¬äºŒå±‚çº¹ç†ç³»ç»Ÿ Demo

RHI Demo ç³»ç»Ÿå¼€å§‹å¼€å‘ç¬¬äºŒå±‚çº¹ç†ç³»ç»Ÿ Demoï¼š

- **texture-2d**: åŸºç¡€ 2D çº¹ç†åŠ è½½å’Œé‡‡æ ·æ¼”ç¤ºï¼Œå±•ç¤º TextureLoader å’Œ ProceduralTexture çš„ä½¿ç”¨ï¼ˆæ–°å¢ï¼‰
  - æ–‡æ¡£ç´¢å¼•ï¼š`/packages/rhi/llmdoc/reference/texture-2d-demo.md`
  - æŠ€æœ¯è¦ç‚¹ï¼šTextureLoader åŠ è½½å¤–éƒ¨å›¾ç‰‡ã€ProceduralTexture ç¨‹åºåŒ–çº¹ç†ã€UV æ˜ å°„ã€é‡‡æ ·å™¨é…ç½®

### 2025-12-10 å®Œæˆ Demo ç³»ç»Ÿæœ€ç»ˆç´¢å¼•æ›´æ–°

RHI Demo ç³»ç»Ÿå·²å®Œæˆå…¨éƒ¨ç¬¬ä¸€å±‚åŸºç¡€æ¸²æŸ“ Demo çš„æ–‡æ¡£ç´¢å¼•æ›´æ–°ï¼š

- **multiple-buffers**: å¤šé¡¶ç‚¹ç¼“å†²åŒºæ¼”ç¤ºï¼Œæ–‡æ¡£ç´¢å¼•å·²æ›´æ–°ï¼ˆ`/packages/rhi/llmdoc/reference/multiple-buffers-demo.md`ï¼‰
- **dynamic-buffer**: åŠ¨æ€ç¼“å†²åŒºæ¼”ç¤ºï¼Œæ–‡æ¡£ç´¢å¼•å·²æ›´æ–°ï¼ˆ`/packages/rhi/llmdoc/reference/dynamic-buffer-demo.md`ï¼‰
- **vertex-formats**: é¡¶ç‚¹æ ¼å¼æ¼”ç¤ºï¼Œæ–‡æ¡£ç´¢å¼•å·²æ›´æ–°ï¼ˆ`/packages/rhi/llmdoc/reference/vertex-formats-demo.md`ï¼‰
- **stencil-test**: æ¨¡æ¿æµ‹è¯•æ¼”ç¤ºï¼Œå·²åœ¨ä¸»ç´¢å¼•ä¸­å®Œæˆæ³¨å†Œ

### 2025-12-10 å®ŒæˆåŸºç¡€æ¸²æŸ“å±‚å…¨éƒ¨ Demo

åŸºç¡€æ¸²æŸ“å±‚ï¼ˆç¬¬ä¸€å±‚ï¼‰12 ä¸ª Demo å…¨éƒ¨å®Œæˆï¼š

- **multiple-buffers**: å¤šé¡¶ç‚¹ç¼“å†²åŒºæ¼”ç¤ºï¼Œå±•ç¤ºå°†ä½ç½®ã€é¢œè‰²ã€æ³•çº¿åˆ†ç¦»åˆ°ä¸åŒç¼“å†²åŒºçš„æŠ€æœ¯ï¼ˆæ–°å¢ï¼‰
- **dynamic-buffer**: ç¼“å†²åŒºåŠ¨æ€æ›´æ–°æ¼”ç¤ºï¼Œå±•ç¤ºæ³¢æµªåŠ¨ç”»æ•ˆæœå’Œ hint: 'dynamic' ä½¿ç”¨ï¼ˆæ–°å¢ï¼‰
- **vertex-formats**: é¡¶ç‚¹æ ¼å¼æ¼”ç¤ºï¼Œå±•ç¤º 4 ç§æ ¼å¼çš„å†…å­˜æ•ˆç‡å¯¹æ¯”ï¼ˆæœ€é«˜èŠ‚çœ 71%ï¼‰ï¼ˆæ–°å¢ï¼‰
- **stencil-test**: æ¨¡æ¿æµ‹è¯•æ¼”ç¤ºï¼Œå±•ç¤ºè½®å»“æ•ˆæœï¼ˆOutline Effectï¼‰çš„ç»å…¸å®ç°ï¼ˆæ–°å¢ï¼‰

### 2025-12-10 æ–°å¢åŸºç¡€æ¸²æŸ“ Demo

æ·»åŠ äº†ä¸¤ä¸ªåŸºç¡€æ¸²æŸ“ Demoï¼Œè¿›ä¸€æ­¥å®Œå–„ RHI Demo ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼š

- **colored-triangle**: é¡¶ç‚¹é¢œè‰²æ’å€¼æ¼”ç¤ºï¼Œå±•ç¤ºçº¢ç»¿è“æ¸å˜æ’å€¼æ•ˆæœ
- **depth-test**: æ·±åº¦æµ‹è¯•æ¼”ç¤ºï¼Œå±•ç¤ºå¤šä¸ªé‡å å‡ ä½•ä½“çš„æ­£ç¡®é®æŒ¡å…³ç³»

### 2025-12-10 æ–°å¢å·¥å…·åº“åŠŸèƒ½

æ·»åŠ äº†å››ä¸ªæ–°çš„å·¥å…·åº“æ¨¡å—ï¼Œè¿›ä¸€æ­¥å®Œå–„ Demo å¼€å‘èƒ½åŠ›ï¼š

- **TextureLoader**: çº¹ç†åŠ è½½å™¨ï¼ˆå›¾ç‰‡åŠ è½½ã€Y è½´ç¿»è½¬ã€Mipmap è‡ªåŠ¨ç”Ÿæˆã€æ‰¹é‡åŠ è½½ï¼‰
- **CubemapGenerator**: ç«‹æ–¹ä½“è´´å›¾å·¥å…·ï¼ˆçº¯è‰²ã€å¤©ç©ºæ¸å˜ã€è°ƒè¯•ç€è‰²ã€ä» URL åŠ è½½ã€å…¨æ™¯å›¾è½¬æ¢ï¼‰
- **RenderTarget**: æ¸²æŸ“ç›®æ ‡ç®¡ç†å™¨ï¼ˆç¦»å±æ¸²æŸ“ã€å¤šæ¸²æŸ“ç›®æ ‡ MRTã€è‡ªåŠ¨èµ„æºç®¡ç†ï¼‰
- **ShaderUtils**: ç€è‰²å™¨å·¥å…·ç±»ï¼ˆUniform å—ç”Ÿæˆã€std140 å¸ƒå±€è®¡ç®—ã€ç€è‰²å™¨æ¨¡æ¿ã€ä»£ç ç‰‡æ®µåº“ï¼‰
- **GeometryGenerator æ‰©å±•**: æ–°å¢ Torusï¼ˆåœ†ç¯ï¼‰ã€Coneï¼ˆåœ†é”¥ï¼‰ã€Cylinderï¼ˆåœ†æŸ±ï¼‰ã€Capsuleï¼ˆèƒ¶å›Šä½“ï¼‰

---

## ä¸€ã€RHI API åŠŸèƒ½æ¨¡å—æ¸…å•

### 1. èµ„æºæ¨¡å— (Resources)

| æ¥å£                 | æ–¹æ³•/å±æ€§                           | WebGL å®ç°çŠ¶æ€           |
| -------------------- | ----------------------------------- | ------------------------ |
| **IRHIBuffer**       | update(), map(), unmap(), destroy() | âœ… å®Œæ•´æ”¯æŒ              |
| **IRHITexture**      | update(), createView(), destroy()   | âœ… 2D/3D/Cube/å‹ç¼©       |
| **IRHITextureView**  | texture, format, dimension          | âœ… é€»è¾‘è§†å›¾              |
| **IRHISampler**      | filter, addressMode                 | âœ… WebGL2åŸç”Ÿ/WebGL1æ¨¡æ‹Ÿ |
| **IRHIShaderModule** | code, stage, reflection             | âœ… GLSLç¼–è¯‘+åå°„         |
| **IRHIQuerySet**     | getResult(), reset()                | âœ… ä»…WebGL2              |

### 2. ç®¡çº¿æ¨¡å— (Pipeline)

| æ¥å£                    | å…³é”®ç‰¹æ€§                                     | WebGL å®ç°çŠ¶æ€ |
| ----------------------- | -------------------------------------------- | -------------- |
| **IRHIRenderPipeline**  | é¡¶ç‚¹å¸ƒå±€, æ··åˆçŠ¶æ€, æ·±åº¦æ¨¡æ¿, Push Constants | âœ… std140 UBO  |
| **IRHIComputePipeline** | è®¡ç®—ç€è‰²å™¨                                   | âŒ WebGLä¸æ”¯æŒ |
| **IRHIPipelineLayout**  | ç»‘å®šç»„å¸ƒå±€                                   | âœ… å®Œæ•´        |

### 3. ç»‘å®šæ¨¡å— (Bindings)

| æ¥å£                    | æ”¯æŒçš„ç»‘å®šç±»å‹                           | WebGL å®ç°çŠ¶æ€      |
| ----------------------- | ---------------------------------------- | ------------------- |
| **IRHIBindGroupLayout** | buffer, sampler, texture, storageTexture | âœ… çº¹ç†å•å…ƒè‡ªåŠ¨åˆ†é… |
| **IRHIBindGroup**       | å®é™…èµ„æºç»‘å®š                             | âœ… uniformæ•°æ®è®¾ç½®  |

### 4. å‘½ä»¤æ¨¡å— (Commands)

| æ¥å£                   | æ–¹æ³•                                                                        | WebGL å®ç°çŠ¶æ€ |
| ---------------------- | --------------------------------------------------------------------------- | -------------- |
| **IRHICommandEncoder** | beginRenderPass(), copy\*()                                                 | âœ… å‘½ä»¤é˜Ÿåˆ—    |
| **IRHIRenderPass**     | draw(), drawIndexed(), drawIndirect(), setViewport(), beginOcclusionQuery() | âœ… å¤šé™„ä»¶æ”¯æŒ  |
| **IRHIComputePass**    | dispatch()                                                                  | âŒ WebGLä¸æ”¯æŒ |

### 5. è®¾å¤‡æ¨¡å— (Device)

| åŠŸèƒ½                    | WebGL å®ç°çŠ¶æ€           |
| ----------------------- | ------------------------ |
| èµ„æºåˆ›å»º (create\*)     | âœ… 11ä¸ªå·¥å‚æ–¹æ³•          |
| ç‰¹æ€§æ£€æµ‹ (hasFeature)   | âœ… 23ä¸ªç‰¹æ€§æ ‡å¿—          |
| æ‰©å±•æ£€æµ‹ (hasExtension) | âœ… WebGLæ‰©å±•æŸ¥è¯¢         |
| ä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ          | âœ… ACTIVE/LOST/DESTROYED |
| èµ„æºè¿½è¸ª                | âœ… è‡ªåŠ¨æ³¨å†Œ+æ³„æ¼æ£€æµ‹     |

---

## äºŒã€å·¥å…·åº“ç»“æ„

```
demo/src/utils/
â”œâ”€â”€ index.ts                    # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ core/                       # æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ DemoRunner.ts           # Demo è¿è¡Œå™¨
â”‚   â””â”€â”€ types.ts                # ç±»å‹å®šä¹‰
â”œâ”€â”€ geometry/                   # å‡ ä½•ä½“ç”Ÿæˆ
â”‚   â”œâ”€â”€ GeometryGenerator.ts    # å‡ ä½•ä½“å·¥å‚
â”‚   â””â”€â”€ types.ts                # å‡ ä½•ä½“ç±»å‹
â”œâ”€â”€ texture/                    # çº¹ç†å·¥å…·
â”‚   â”œâ”€â”€ TextureLoader.ts        # çº¹ç†åŠ è½½å™¨ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ CubemapGenerator.ts     # ç«‹æ–¹ä½“è´´å›¾ç”Ÿæˆå™¨ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ ProceduralTexture.ts    # ç¨‹åºåŒ–çº¹ç†
â”‚   â””â”€â”€ types.ts                # çº¹ç†ç±»å‹
â”œâ”€â”€ rendering/                  # æ¸²æŸ“å·¥å…·ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ RenderTarget.ts         # æ¸²æŸ“ç›®æ ‡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ types.ts                # æ¸²æŸ“ç±»å‹
â”‚   â””â”€â”€ index.ts                # å¯¼å‡º
â”œâ”€â”€ shader/                     # ç€è‰²å™¨å·¥å…·ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ ShaderUtils.ts          # ç€è‰²å™¨å·¥å…·ç±»
â”‚   â”œâ”€â”€ types.ts                # ç€è‰²å™¨ç±»å‹
â”‚   â””â”€â”€ index.ts                # å¯¼å‡º
â”œâ”€â”€ shadow/                     # é˜´å½±å·¥å…·ï¼ˆ2025-12-16æ–°å¢ï¼‰
â”‚   â”œâ”€â”€ ShadowMap.ts            # é˜´å½±è´´å›¾ç®¡ç†å™¨
â”‚   â”œâ”€â”€ LightSpaceMatrix.ts     # å…‰æºç©ºé—´çŸ©é˜µè®¡ç®—
â”‚   â”œâ”€â”€ PCFFilter.ts            # PCFè½¯é˜´å½±æ»¤æ³¢å™¨
â”‚   â”œâ”€â”€ ShadowShaders.ts        # é˜´å½±ç€è‰²å™¨ä»£ç ç”Ÿæˆ
â”‚   â”œâ”€â”€ types.ts                # é˜´å½±ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts                # å¯¼å‡º
â”œâ”€â”€ postprocess/                # åå¤„ç†å·¥å…·ï¼ˆ2025-12-16æ–°å¢ï¼‰
â”‚   â”œâ”€â”€ PostProcessManager.ts   # åå¤„ç†ç®¡é“ç®¡ç†å™¨
â”‚   â”œâ”€â”€ PostProcessEffect.ts    # åå¤„ç†æ•ˆæœåŸºç±»
â”‚   â”œâ”€â”€ effects/                # å†…ç½®æ•ˆæœ
â”‚   â”‚   â”œâ”€â”€ BrightnessContrast.ts  # äº®åº¦/å¯¹æ¯”åº¦
â”‚   â”‚   â”œâ”€â”€ GaussianBlur.ts        # é«˜æ–¯æ¨¡ç³Š
â”‚   â”‚   â”œâ”€â”€ ToneMapping.ts         # è‰²è°ƒæ˜ å°„
â”‚   â”‚   â””â”€â”€ FXAA.ts                # å¿«é€ŸæŠ—é”¯é½¿
â”‚   â”œâ”€â”€ types.ts                # åå¤„ç†ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts                # å¯¼å‡º
â”œâ”€â”€ camera/                     # ç›¸æœºç³»ç»Ÿ
â”‚   â”œâ”€â”€ OrbitController.ts      # è½¨é“æ§åˆ¶å™¨
â”‚   â””â”€â”€ types.ts                # ç›¸æœºç±»å‹
â””â”€â”€ ui/                         # UI å·¥å…·
    â”œâ”€â”€ SimpleGUI.ts            # é›¶ä¾èµ– GUI é¢æ¿
    â”œâ”€â”€ Stats.ts                # æ€§èƒ½ç»Ÿè®¡é¢æ¿
    â””â”€â”€ types.ts                # UI ç±»å‹
```

**æ³¨æ„**: æ•°å­¦åº“ä½¿ç”¨ `@maxellabs/math` åŒ…ä¸­çš„ `MMath`ã€‚å·¥å…·åº“å·²éšæ¼”ç¤ºç³»ç»Ÿé‡æ„å®Œæˆã€‚

---

## ä¸‰ã€å·²å®ç°å·¥å…·

### DemoRunner (æ ¸å¿ƒ)

ç»Ÿä¸€çš„ Demo ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š

```typescript
import { DemoRunner, GeometryGenerator } from './utils';

const runner = new DemoRunner({
  canvasId: 'J-canvas',
  name: 'Demo Name',
  clearColor: [0.1, 0.1, 0.1, 1.0],
});

await runner.init();

const geometry = GeometryGenerator.triangle({ colors: true });
const buffer = runner.track(runner.device.createBuffer({...}));

runner.start((dt) => {
  const { encoder, passDescriptor } = runner.beginFrame();
  // æ¸²æŸ“ä»£ç 
  runner.endFrame(encoder);
});
```

### GeometryGenerator (å‡ ä½•ä½“)

æ”¯æŒçš„å‡ ä½•ä½“ï¼š

- `triangle(options)` - ä¸‰è§’å½¢
- `quad(options)` - å››è¾¹å½¢
- `cube(options)` - ç«‹æ–¹ä½“
- `plane(options)` - å¹³é¢
- `sphere(options)` - çƒä½“
- `torus(options)` - åœ†ç¯ï¼ˆæ–°å¢ï¼‰
- `cone(options)` - åœ†é”¥ï¼ˆæ–°å¢ï¼‰
- `cylinder(options)` - åœ†æŸ±ï¼ˆæ–°å¢ï¼‰
- `capsule(options)` - èƒ¶å›Šä½“ï¼ˆæ–°å¢ï¼‰

### TextureLoader (çº¹ç†åŠ è½½å™¨ - æ–°å¢)

å›¾ç‰‡åŠ è½½å’Œå¤„ç†å·¥å…·ï¼š

- `load(url, options)` - ä» URL åŠ è½½å•å¼ å›¾ç‰‡çº¹ç†
- `loadAll(urls, options)` - æ‰¹é‡åŠ è½½å¤šå¼ å›¾ç‰‡
- `fromImage(image, options)` - ä» HTMLImageElement åˆ›å»ºçº¹ç†æ•°æ®
- `fromImageData(imageData, options)` - ä» ImageData åˆ›å»ºçº¹ç†æ•°æ®
- `generateMipmaps(data, width, height)` - ç”Ÿæˆ Mipmap é“¾ï¼ˆåŒçº¿æ€§æ’å€¼ï¼‰
- `isCompressedFormat(url)` - æ£€æµ‹ KTX/KTX2/DDS å‹ç¼©çº¹ç†æ ¼å¼

é€‰é¡¹æ”¯æŒï¼š

- `flipY` - Y è½´ç¿»è½¬ï¼ˆç¬¦åˆ WebGL åæ ‡ç³»ï¼‰ï¼Œé»˜è®¤ `true`
- `generateMipmaps` - è‡ªåŠ¨ç”Ÿæˆ Mipmap é“¾ï¼Œé»˜è®¤ `false`
- `premultiplyAlpha` - é¢„ä¹˜ Alpha å¤„ç†ï¼Œé»˜è®¤ `false`
- `format` - çº¹ç†æ ¼å¼ï¼Œé»˜è®¤ `'rgba8-unorm'`

```typescript
// ä» URL åŠ è½½å•å¼ å›¾ç‰‡
const texture = await TextureLoader.load('path/to/image.jpg', {
  flipY: true,
  generateMipmaps: true,
});

// æ‰¹é‡åŠ è½½
const textures = await TextureLoader.loadAll(['texture1.jpg', 'texture2.jpg']);
```

### CubemapGenerator (ç«‹æ–¹ä½“è´´å›¾ - æ–°å¢)

ç”Ÿæˆå’ŒåŠ è½½ç«‹æ–¹ä½“è´´å›¾ï¼ˆå¤©ç©ºç›’ã€ç¯å¢ƒæ˜ å°„ç­‰ï¼‰ï¼š

- `solidColor(config)` - ç”Ÿæˆçº¯è‰²ç«‹æ–¹ä½“è´´å›¾
- `skyGradient(config)` - ç”Ÿæˆå¤©ç©ºæ¸å˜ç«‹æ–¹ä½“è´´å›¾ï¼ˆé¡¶éƒ¨-ä¸­é—´-åº•éƒ¨ï¼‰
- `debug(config)` - ç”Ÿæˆè°ƒè¯•ç”¨ç«‹æ–¹ä½“è´´å›¾ï¼ˆæ¯ä¸ªé¢ä¸åŒé¢œè‰²ï¼‰
- `loadFromUrls(urls)` - ä» 6 å¼ å›¾ç‰‡ URL åŠ è½½ç«‹æ–¹ä½“è´´å›¾
- `fromEquirectangular(url, size)` - ä»å…¨æ™¯å›¾ï¼ˆç­‰è·æŸ±çŠ¶æŠ•å½±ï¼‰è½¬æ¢ä¸ºç«‹æ–¹ä½“è´´å›¾

```typescript
// åˆ›å»ºå¤©ç©ºæ¸å˜ç«‹æ–¹ä½“è´´å›¾
const cubemap = CubemapGenerator.skyGradient({
  topColor: [135, 206, 250, 255], // å¤©ç©ºè“
  horizonColor: [176, 196, 222, 255], // æ·¡è“
  bottomColor: [139, 69, 19, 255], // åœ°é¢æ£•
  size: 256,
});

// è°ƒè¯•ç«‹æ–¹ä½“è´´å›¾
const debug = CubemapGenerator.debug({ size: 256, showLabels: true });

// ä»å…¨æ™¯å›¾åŠ è½½
const cubemapFromPanorama = await CubemapGenerator.fromEquirectangular('panorama.jpg', 512);
```

### RenderTarget (æ¸²æŸ“ç›®æ ‡ - æ–°å¢)

ç®€åŒ–ç¦»å±æ¸²æŸ“çš„å°è£…ï¼Œè‡ªåŠ¨ç®¡ç† FBO å’Œçº¹ç†èµ„æºï¼š

- æ”¯æŒå¤šæ¸²æŸ“ç›®æ ‡ï¼ˆMRT - Multiple Render Targetsï¼‰
- è‡ªåŠ¨èµ„æºè¿½è¸ªå’Œç”Ÿå‘½å‘¨æœŸç®¡ç†
- å¯é€‰æ·±åº¦/æ¨¡æ¿é™„ä»¶
- åŠ¨æ€è°ƒæ•´å¤§å°

ä¸»è¦æ–¹æ³•ï¼š

- `getRenderPassDescriptor(clearColor?, depthClearValue?)` - è·å–æ¸²æŸ“é€šé“æè¿°ç¬¦
- `getColorView(index)` - è·å–é¢œè‰²é™„ä»¶çº¹ç†è§†å›¾
- `getColorTexture(index)` - è·å–é¢œè‰²é™„ä»¶çº¹ç†
- `getDepthView()` - è·å–æ·±åº¦é™„ä»¶çº¹ç†è§†å›¾
- `getDepthTexture()` - è·å–æ·±åº¦é™„ä»¶çº¹ç†
- `resize(width, height)` - è°ƒæ•´æ¸²æŸ“ç›®æ ‡å¤§å°
- `destroy()` - é”€æ¯æ‰€æœ‰èµ„æº

```typescript
const renderTarget = runner.track(
  new RenderTarget(runner.device, {
    width: 800,
    height: 600,
    colorAttachmentCount: 2, // MRT with 2 targets
    depthFormat: RHITextureFormat.DEPTH24_UNORM_STENCIL8,
  })
);

// è·å–æ¸²æŸ“é€šé“æè¿°ç¬¦
const passDescriptor = renderTarget.getRenderPassDescriptor([0.1, 0.1, 0.1, 1.0]);

// è·å–é¢œè‰²çº¹ç†è¿›è¡Œåç»­é‡‡æ ·
const colorTexture = renderTarget.getColorView(0);
```

### ShaderUtils (ç€è‰²å™¨å·¥å…· - æ–°å¢)

ç”Ÿæˆå’Œç®¡ç†ç€è‰²å™¨ä»£ç ï¼š

**Uniform å—å·¥å…·ï¼š**

- `generateUniformBlock(definition)` - ç”Ÿæˆ Uniform å— GLSL ä»£ç ï¼ˆstd140 å¸ƒå±€ï¼‰
- `calculateUniformBlockSize(fields)` - è®¡ç®— std140 å¸ƒå±€å¤§å°ï¼ˆå­—èŠ‚ï¼‰
- `calculateUniformBlockLayout(fields)` - è·å–è¯¦ç»†å¸ƒå±€ä¿¡æ¯ï¼ˆå­—æ®µåç§»ï¼‰

**æ ‡å‡† Uniform å—ï¼š**

- `getTransformsBlock(binding)` - MVP çŸ©é˜µå—ï¼ˆuModelMatrix, uViewMatrix, uProjectionMatrixï¼‰
- `getLightingBlock(binding)` - å…‰ç…§å‚æ•°å—ï¼ˆuLightPosition, uLightColor, uAmbientColorï¼‰
- `getMaterialBlock(binding)` - æè´¨å‚æ•°å—ï¼ˆuAmbientColor, uDiffuseColor, uSpecularColor, uShininessï¼‰

**ç€è‰²å™¨æ¨¡æ¿ï¼š**

- `basicVertexShader(options)` - åŸºç¡€é¡¶ç‚¹ç€è‰²å™¨ï¼ˆæ”¯æŒæ³•çº¿ã€UVã€é¡¶ç‚¹é¢œè‰²ï¼‰
- `basicFragmentShader(options)` - åŸºç¡€ç‰‡æ®µç€è‰²å™¨ï¼ˆæ”¯æŒçº¯è‰²ã€é¡¶ç‚¹é¢œè‰²ã€çº¹ç†ã€å…‰ç…§ï¼‰
- `phongShaders()` - å®Œæ•´çš„ Phong å…‰ç…§ç€è‰²å™¨å¯¹ï¼ˆé¡¶ç‚¹ + ç‰‡æ®µï¼‰

**ç€è‰²å™¨ç‰‡æ®µåº“ï¼š**

- `getLightingSnippet()` - Phong å…‰ç…§è®¡ç®—ä»£ç ç‰‡æ®µ
- `getNormalTransformSnippet()` - æ³•çº¿å˜æ¢ä»£ç ç‰‡æ®µ
- `getTextureSamplingSnippet()` - çº¹ç†é‡‡æ ·ä»£ç ç‰‡æ®µ
- `getCommonUniformsSnippet()` - å¸¸è§ Uniform å£°æ˜
- `getScreenPositionSnippet()` - å±å¹•ç©ºé—´ä½ç½®è®¡ç®—

```typescript
// ç”Ÿæˆ Uniform å—
const block = ShaderUtils.generateUniformBlock({
  name: 'Transforms',
  binding: 0,
  fields: [
    { name: 'uModelMatrix', type: 'mat4' },
    { name: 'uViewMatrix', type: 'mat4' },
    { name: 'uProjectionMatrix', type: 'mat4' },
  ],
});

// è®¡ç®— Uniform å—å¤§å°
const size = ShaderUtils.calculateUniformBlockSize([
  { name: 'time', type: 'float' },
  { name: 'color', type: 'vec3' },
]);

// ä½¿ç”¨ç€è‰²å™¨æ¨¡æ¿
const vs = ShaderUtils.basicVertexShader({
  hasNormals: true,
  hasUVs: true,
  hasColors: false,
});

const fs = ShaderUtils.basicFragmentShader({
  mode: 'texture',
  hasLighting: true,
});

// Phong ç€è‰²å™¨
const { vertex, fragment } = ShaderUtils.phongShaders();
```

### ShadowMap (é˜´å½±è´´å›¾ - 2025-12-16æ–°å¢)

é˜´å½±è´´å›¾ç®¡ç†å™¨ï¼Œå°è£…æ·±åº¦çº¹ç†åˆ›å»ºå’Œç®¡ç†ï¼š

- `getRenderPassDescriptor()` - è·å–é˜´å½±Passæ¸²æŸ“é€šé“æè¿°ç¬¦
- `resize(resolution)` - åŠ¨æ€è°ƒæ•´åˆ†è¾¨ç‡
- `depthTexture` / `depthView` - æ·±åº¦çº¹ç†å’Œè§†å›¾
- `sampler` - æ¯”è¾ƒé‡‡æ ·å™¨ï¼ˆç”¨äºPCFï¼‰

```typescript
import { ShadowMap, LightSpaceMatrix, PCFFilter } from './utils';

// åˆ›å»ºé˜´å½±è´´å›¾
const shadowMap = runner.track(new ShadowMap(runner.device, {
  resolution: 1024,
  label: 'Main Shadow Map',
}));

// è®¡ç®—å…‰æºçŸ©é˜µ
const lightMatrix = new LightSpaceMatrix();
lightMatrix.updateDirectional({
  direction: [0.5, -1, 0.3],
  orthoSize: 15,
  near: 1,
  far: 50,
});

// é˜´å½±Pass
const shadowPassDesc = shadowMap.getRenderPassDescriptor();
const shadowPass = encoder.beginRenderPass(shadowPassDesc);
// ... æ¸²æŸ“é˜´å½±æŠ•å°„ç‰©
shadowPass.end();

// åœºæ™¯Passä¸­ä½¿ç”¨é˜´å½±è´´å›¾
bindGroup.setTexture(shadowMap.depthView);
bindGroup.setSampler(shadowMap.sampler);
```

### PCFFilter (PCFè½¯é˜´å½± - 2025-12-16æ–°å¢)

PCFè½¯é˜´å½±æ»¤æ³¢å™¨ï¼Œç”Ÿæˆé˜´å½±é‡‡æ ·ç€è‰²å™¨ä»£ç ï¼š

- `getShaderSnippet(options)` - è·å–PCFç€è‰²å™¨ä»£ç ç‰‡æ®µ
- `getShadowUniformBlock(binding)` - è·å–é˜´å½±Uniform Blockå£°æ˜
- `getSampleCount(mode)` - è·å–é‡‡æ ·æ¬¡æ•°

æ”¯æŒçš„é‡‡æ ·æ¨¡å¼ï¼š
- `1x1` - ç¡¬é˜´å½±ï¼ˆ1æ¬¡é‡‡æ ·ï¼‰
- `2x2` - åŸºç¡€è½¯é˜´å½±ï¼ˆ4æ¬¡é‡‡æ ·ï¼‰
- `3x3` - é«˜è´¨é‡è½¯é˜´å½±ï¼ˆ9æ¬¡é‡‡æ ·ï¼‰
- `5x5` - è¶…é«˜è´¨é‡è½¯é˜´å½±ï¼ˆ25æ¬¡é‡‡æ ·ï¼‰

```typescript
// è·å–PCFç€è‰²å™¨ä»£ç 
const pcfCode = PCFFilter.getShaderSnippet({
  sampleMode: '3x3',
  bias: 0.005,
});

// åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­ä½¿ç”¨
const fragmentShader = `
  ${PCFFilter.getUniformDeclaration()}
  ${pcfCode}

  void main() {
    float shadow = calculateShadow(vLightSpacePos, uShadowMap);
    vec3 color = (1.0 - shadow) * diffuse + ambient;
    fragColor = vec4(color, 1.0);
  }
`;
```

### ShadowShaders (é˜´å½±ç€è‰²å™¨ - 2025-12-16æ–°å¢)

é˜´å½±ç€è‰²å™¨ä»£ç ç”Ÿæˆå™¨ï¼š

- `getDepthVertexShader()` - æ·±åº¦Passé¡¶ç‚¹ç€è‰²å™¨
- `getDepthFragmentShader()` - æ·±åº¦Passç‰‡å…ƒç€è‰²å™¨
- `getSceneVertexShader(options)` - åœºæ™¯Passé¡¶ç‚¹ç€è‰²å™¨ï¼ˆå¸¦é˜´å½±ï¼‰
- `getSceneFragmentShader(options)` - åœºæ™¯Passç‰‡å…ƒç€è‰²å™¨ï¼ˆå¸¦é˜´å½±ï¼‰

```typescript
import { ShadowShaders } from './utils';

// æ·±åº¦Passç€è‰²å™¨
const depthVS = ShadowShaders.getDepthVertexShader();
const depthFS = ShadowShaders.getDepthFragmentShader();

// åœºæ™¯Passç€è‰²å™¨ï¼ˆå¸¦é˜´å½±æ”¯æŒï¼‰
const sceneVS = ShadowShaders.getSceneVertexShader({ hasNormals: true });
const sceneFS = ShadowShaders.getSceneFragmentShader({
  hasNormals: true,
  pcfMode: '3x3',
  shadowBias: 0.005,
});
```

### InstanceBuffer (å®ä¾‹ç¼“å†²åŒºç®¡ç†å™¨ - 2025-12-16æ–°å¢)

å®ä¾‹åŒ–æ¸²æŸ“çš„æ•°æ®ç¼“å†²åŒºç®¡ç†å™¨ï¼Œè´Ÿè´£ GPU ç¼“å†²åŒºå’Œæ•°æ®æ›´æ–°ï¼š

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- é¢„åˆ†é… CPU å’Œ GPU ç¼“å†²åŒºï¼Œé¿å…æ¸²æŸ“å¾ªç¯ä¸­çš„å†…å­˜åˆ†é…
- æ”¯æŒå•ä¸ªå®ä¾‹å’Œæ‰¹é‡å®ä¾‹çš„é«˜æ•ˆæ›´æ–°
- åŠ¨æ€æ‰©å®¹æ”¯æŒï¼ˆresizeï¼‰
- è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆå†…å­˜ä½¿ç”¨ã€å®ä¾‹æ•°ç­‰ï¼‰

**æ ‡å‡†æ•°æ®å¸ƒå±€ï¼ˆ80 bytes per instanceï¼‰**ï¼š
```
[0-63]   mat4 modelMatrix  (64 bytes)
[64-79]  vec4 color        (16 bytes)
```

**API æ–¹æ³•**ï¼š
- `updateInstance(index, data)` - æ›´æ–°å•ä¸ªå®ä¾‹
- `updateInstances(startIndex, data, count)` - æ‰¹é‡æ›´æ–°ï¼ˆæ¨èï¼‰
- `updateAll(data, count)` - æ›´æ–°å…¨éƒ¨å®ä¾‹
- `resize(newMaxInstances)` - åŠ¨æ€æ‰©å®¹
- `getBuffer()` - è·å– GPU ç¼“å†²åŒº
- `getStats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```typescript
import { InstanceBuffer, getStandardInstanceLayout } from './utils';

// 1. åˆ›å»ºå®ä¾‹ç¼“å†²åŒº
const instanceBuffer = runner.track(new InstanceBuffer(runner.device, {
  maxInstances: 10000,
  instanceLayout: getStandardInstanceLayout(2), // location 2-6
  dynamic: true,
  label: 'MyInstanceBuffer',
}));

// 2. æ›´æ–°å•ä¸ªå®ä¾‹æ•°æ®
const instanceData = new Float32Array(20); // 80 bytes = 20 floats
// [0-15]: mat4 modelMatrix (16 floats)
MMath.Matrix4.identity().toArray(instanceData, 0);
// [16-19]: vec4 color (4 floats)
instanceData.set([1.0, 0.0, 0.0, 1.0], 16);
instanceBuffer.updateInstance(0, instanceData);

// 3. æ‰¹é‡æ›´æ–°ï¼ˆæ›´é«˜æ•ˆï¼‰
const batchData = new Float32Array(100 * 20); // 100 instances
for (let i = 0; i < 100; i++) {
  const offset = i * 20;
  // è®¾ç½®å˜æ¢çŸ©é˜µ
  const matrix = MMath.Matrix4.translation(i * 2, 0, 0);
  matrix.toArray(batchData, offset);
  // è®¾ç½®é¢œè‰²
  batchData.set([Math.random(), Math.random(), Math.random(), 1.0], offset + 16);
}
instanceBuffer.updateInstances(0, batchData, 100);

// 4. è·å–ç»Ÿè®¡ä¿¡æ¯
const stats = instanceBuffer.getStats();
console.log(`Using ${stats.usage * 100}% of buffer capacity`);
console.log(`Buffer size: ${stats.bufferSize / 1024} KB`);
```

### InstancedRenderer (å®ä¾‹åŒ–æ¸²æŸ“å™¨ - 2025-12-16æ–°å¢)

å°è£…å®ä¾‹åŒ–æ¸²æŸ“çš„æ ¸å¿ƒé€»è¾‘ï¼Œç®€åŒ–å®ä¾‹åŒ– Draw Call çš„ä½¿ç”¨ï¼š

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- è‡ªåŠ¨ç»„åˆåŸºç¡€å‡ ä½•å’Œå®ä¾‹å±æ€§çš„é¡¶ç‚¹å¸ƒå±€
- æ”¯æŒç´¢å¼•å’Œéç´¢å¼•æ¸²æŸ“
- å°è£… drawIndexed() / draw() è°ƒç”¨
- æä¾›é¡¶ç‚¹å¸ƒå±€æŸ¥è¯¢æ¥å£ï¼ˆç”¨äºåˆ›å»ºæ¸²æŸ“ç®¡çº¿ï¼‰

**API æ–¹æ³•**ï¼š
- `draw(renderPass, instanceCount)` - æ‰§è¡Œå®ä¾‹åŒ–æ¸²æŸ“
- `getVertexBufferLayouts(baseStride?)` - è·å–é¡¶ç‚¹å¸ƒå±€ï¼ˆæ ‡å‡†ï¼‰
- `getVertexBufferLayoutsExtended(baseAttributes)` - è·å–é¡¶ç‚¹å¸ƒå±€ï¼ˆæ‰©å±•ï¼‰
- `updateGeometry(newGeometry)` - è¿è¡Œæ—¶åˆ‡æ¢å‡ ä½•ä½“

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```typescript
import {
  InstanceBuffer,
  InstancedRenderer,
  getStandardInstanceLayout,
  GeometryGenerator,
} from './utils';

// 1. åˆ›å»ºå®ä¾‹ç¼“å†²åŒº
const instanceBuffer = runner.track(new InstanceBuffer(runner.device, {
  maxInstances: 10000,
  instanceLayout: getStandardInstanceLayout(2),
}));

// 2. åˆ›å»ºåŸºç¡€å‡ ä½•ä½“
const cubeGeometry = GeometryGenerator.createCube({ size: 1.0 });
const vertexBuffer = runner.createVertexBuffer(
  cubeGeometry.vertices,
  'CubeVertices'
);
const indexBuffer = runner.createIndexBuffer(
  cubeGeometry.indices,
  'CubeIndices'
);

// 3. åˆ›å»ºå®ä¾‹åŒ–æ¸²æŸ“å™¨
const renderer = runner.track(new InstancedRenderer(runner.device, instanceBuffer, {
  vertexBuffer,
  indexBuffer,
  vertexCount: cubeGeometry.vertexCount,
  indexCount: cubeGeometry.indexCount,
  indexFormat: 'uint16',
}));

// 4. åˆ›å»ºæ¸²æŸ“ç®¡çº¿ï¼ˆä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„é¡¶ç‚¹å¸ƒå±€ï¼‰
const vertexBufferLayouts = renderer.getVertexBufferLayouts(24); // 24 = vec3 pos + vec3 normal
const pipeline = runner.device.createRenderPipeline({
  label: 'InstancedPipeline',
  vertex: {
    module: vertexShader,
    entryPoint: 'main',
    buffers: vertexBufferLayouts,
  },
  fragment: {
    module: fragmentShader,
    entryPoint: 'main',
    targets: [{ format: runner.format }],
  },
  primitive: { topology: 'triangle-list' },
  depthStencil: {
    format: 'depth24-unorm',
    depthWriteEnabled: true,
    depthCompare: 'less',
  },
});

// 5. æ›´æ–°å®ä¾‹æ•°æ®ï¼ˆæ¯å¸§æˆ–æŒ‰éœ€ï¼‰
const instanceData = new Float32Array(10000 * 20);
for (let i = 0; i < 10000; i++) {
  const offset = i * 20;
  // è®¡ç®—ä½ç½®ï¼ˆ10x10x100 ç½‘æ ¼ï¼‰
  const x = (i % 100) * 2 - 100;
  const y = Math.floor((i / 100) % 100) * 2 - 100;
  const z = Math.floor(i / 10000) * 2;

  const matrix = MMath.Matrix4.translation(x, y, z);
  matrix.toArray(instanceData, offset);

  // éšæœºé¢œè‰²
  instanceData.set([Math.random(), Math.random(), Math.random(), 1.0], offset + 16);
}
instanceBuffer.updateAll(instanceData, 10000);

// 6. æ¸²æŸ“
renderPass.setPipeline(pipeline);
renderer.draw(renderPass, instanceBuffer.getInstanceCount());
```

**ç€è‰²å™¨ç¤ºä¾‹ï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰**ï¼š
```glsl
#version 300 es
precision highp float;

// Per-vertex attributes
layout(location = 0) in vec3 aPosition;
layout(location = 1) in vec3 aNormal;

// Per-instance attributes
layout(location = 2) in vec4 aInstanceMatrixRow0;
layout(location = 3) in vec4 aInstanceMatrixRow1;
layout(location = 4) in vec4 aInstanceMatrixRow2;
layout(location = 5) in vec4 aInstanceMatrixRow3;
layout(location = 6) in vec4 aInstanceColor;

// Uniforms
layout(std140, binding = 0) uniform Camera {
  mat4 uViewMatrix;
  mat4 uProjectionMatrix;
};

// Outputs
out vec3 vWorldNormal;
out vec4 vInstanceColor;

void main() {
  // é‡å»ºå®ä¾‹æ¨¡å‹çŸ©é˜µ
  mat4 instanceMatrix = mat4(
    aInstanceMatrixRow0,
    aInstanceMatrixRow1,
    aInstanceMatrixRow2,
    aInstanceMatrixRow3
  );

  vec4 worldPos = instanceMatrix * vec4(aPosition, 1.0);
  mat3 normalMatrix = transpose(inverse(mat3(instanceMatrix)));
  vWorldNormal = normalize(normalMatrix * aNormal);
  vInstanceColor = aInstanceColor;

  gl_Position = uProjectionMatrix * uViewMatrix * worldPos;
}
```

**æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š
1. **æ‰¹é‡æ›´æ–°ä¼˜å…ˆ**ï¼šä½¿ç”¨ `updateInstances()` è€Œéå¤šæ¬¡ `updateInstance()`
2. **é¢„åˆ†é…å®¹é‡**ï¼šæ ¹æ®æœ€å¤§å®ä¾‹æ•°é¢„åˆ†é…ç¼“å†²åŒºï¼Œé¿å…è¿è¡Œæ—¶æ‰©å®¹
3. **åŠ¨æ€æ›´æ–°ç­–ç•¥**ï¼šåªæ›´æ–°å˜åŒ–çš„å®ä¾‹ï¼Œå‡å°‘ GPU æ•°æ®ä¼ è¾“
4. **å®ä¾‹æ•°æ§åˆ¶**ï¼šé€šè¿‡ `setInstanceCount()` çµæ´»æ§åˆ¶æ¸²æŸ“çš„å®ä¾‹æ•°é‡
5. **LOD æ”¯æŒ**ï¼šæ ¹æ®è·ç¦»åŠ¨æ€è°ƒæ•´å®ä¾‹æ•°å’Œå‡ ä½•ä½“ç»†èŠ‚

**é€‚ç”¨åœºæ™¯**ï¼š
- æ¤è¢«æ¸²æŸ“ï¼ˆè‰ã€æ ‘æœ¨ã€çŒæœ¨ï¼‰
- ç²’å­ç³»ç»Ÿï¼ˆçƒŸé›¾ã€ç«èŠ±ã€é›¨é›ªï¼‰
- å»ºç­‘é˜µåˆ—ï¼ˆåŸå¸‚ã€è¡—åŒºï¼‰
- å¤§é‡é‡å¤å¯¹è±¡ï¼ˆå²©çŸ³ã€éšœç¢ç‰©ï¼‰
- æ€§èƒ½æµ‹è¯•ï¼ˆå‹åŠ›æµ‹è¯•ã€æ¸²æŸ“åŸºå‡†ï¼‰

### ProceduralTexture (ç¨‹åºåŒ–çº¹ç†)

æ”¯æŒçš„çº¹ç†ç±»å‹ï¼š

- `checkerboard(config)` - æ£‹ç›˜æ ¼
- `gradient(config)` - æ¸å˜
- `noise(config)` - å™ªå£° (white/perlin)
- `solidColor(config)` - çº¯è‰²
- `uvDebug(config)` - UV è°ƒè¯•
- `normalMap(config)` - æ³•çº¿è´´å›¾

### PostProcessManager (åå¤„ç†ç®¡é“ - 2025-12-16æ–°å¢)

åå¤„ç†ç®¡é“ç®¡ç†å™¨ï¼Œæ”¯æŒå¤šæ•ˆæœé“¾å¼æ‰§è¡Œå’ŒPing-Pongç¼“å†²åŒºç®¡ç†ï¼š

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- ç®¡ç†å¤šä¸ªåå¤„ç†æ•ˆæœçš„é“¾å¼æ‰§è¡Œ
- Ping-Pongç¼“å†²åŒºè‡ªåŠ¨ç®¡ç†ï¼ˆé¿å…è¯»å†™å†²çªï¼‰
- æ”¯æŒHDR/LDRæ ¼å¼åˆ‡æ¢
- è‡ªåŠ¨èµ„æºè¿½è¸ªå’Œæ¸…ç†

**å†…ç½®åå¤„ç†æ•ˆæœ**ï¼š
- **BrightnessContrast** - äº®åº¦/å¯¹æ¯”åº¦è°ƒæ•´
- **GaussianBlur** - é«˜æ–¯æ¨¡ç³Šï¼ˆ5-tapä¼˜åŒ–ï¼‰
- **ToneMapping** - è‰²è°ƒæ˜ å°„ï¼ˆReinhard/ACES/Uncharted2/Filmicï¼‰
- **FXAA** - å¿«é€ŸæŠ—é”¯é½¿

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```typescript
import {
  PostProcessManager,
  ToneMapping,
  FXAA,
  BrightnessContrast,
} from './utils';

// 1. åˆ›å»ºåå¤„ç†ç®¡ç†å™¨
const postProcess = runner.track(new PostProcessManager(runner.device, {
  width: runner.width,
  height: runner.height,
  useHDR: false,
}));

// 2. æ·»åŠ æ•ˆæœé“¾ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰
postProcess.addEffect(new ToneMapping(runner.device, {
  mode: 'aces',
  exposure: 1.0,
  gamma: 2.2,
}));

postProcess.addEffect(new BrightnessContrast(runner.device, {
  brightness: 0.1,
  contrast: 1.1,
}));

postProcess.addEffect(new FXAA(runner.device, {
  subpixelQuality: 0.75,
  edgeThreshold: 0.166,
}));

// 3. æ¸²æŸ“å¾ªç¯ä¸­åº”ç”¨åå¤„ç†
runner.start((dt) => {
  const { encoder, passDescriptor } = runner.beginFrame();

  // ç¬¬ä¸€æ­¥ï¼šæ¸²æŸ“åœºæ™¯åˆ°ç¦»å±çº¹ç†
  const sceneTarget = runner.track(new RenderTarget(runner.device, {
    width: runner.width,
    height: runner.height,
    depthFormat: 'depth24-unorm',
  }));

  const scenePass = encoder.beginRenderPass(
    sceneTarget.getRenderPassDescriptor([0.1, 0.1, 0.1, 1.0])
  );
  // ... æ¸²æŸ“åœºæ™¯ ...
  scenePass.end();

  // ç¬¬äºŒæ­¥ï¼šåº”ç”¨åå¤„ç†é“¾
  const finalTexture = postProcess.process(encoder, sceneTarget.getColorView(0));

  // ç¬¬ä¸‰æ­¥ï¼šè¾“å‡ºåˆ°å±å¹•
  const screenPass = encoder.beginRenderPass(passDescriptor);
  // ... å°†finalTextureç»˜åˆ¶åˆ°å±å¹• ...
  screenPass.end();

  runner.endFrame(encoder);
});

// 4. åŠ¨æ€è°ƒæ•´æ•ˆæœå‚æ•°
const toneMappingEffect = postProcess.getEffectByName('ToneMapping');
toneMappingEffect?.setParameters({ exposure: 1.5 });

// 5. å¯ç”¨/ç¦ç”¨ç‰¹å®šæ•ˆæœ
const fxaaEffect = postProcess.getEffectByName('FXAA');
if (fxaaEffect) fxaaEffect.enabled = false;

// 6. è·å–ç»Ÿè®¡ä¿¡æ¯
const stats = postProcess.getStats();
console.log(`Effects: ${stats.enabledEffectCount}/${stats.effectCount}`);
console.log(`Memory: ${(stats.totalMemoryUsage / 1024 / 1024).toFixed(2)} MB`);
```

**è‡ªå®šä¹‰åå¤„ç†æ•ˆæœ**ï¼š
```typescript
import { PostProcessEffect } from './utils';

class CustomEffect extends PostProcessEffect {
  protected createPipeline(): void {
    // åˆ›å»ºæ¸²æŸ“ç®¡çº¿
    const vertexShader = this.device.createShaderModule({
      code: this.getFullscreenVertexShader(), // åŸºç±»æä¾›å…¨å±é¡¶ç‚¹ç€è‰²å™¨
    });

    const fragmentShader = this.device.createShaderModule({
      code: this.getFragmentShader(),
    });

    // ... åˆ›å»ºç®¡çº¿ ...
  }

  protected createBindGroup(inputTexture: MSpec.IRHITextureView): void {
    // åˆ›å»ºç»‘å®šç»„
  }

  protected updateUniforms(): void {
    // æ›´æ–°Uniformå‚æ•°
  }

  public setParameters(params: Record<string, any>): void {
    // å¤„ç†å‚æ•°æ›´æ–°
  }

  private getFragmentShader(): string {
    return `#version 300 es
precision mediump float;

in vec2 vUV;
out vec4 fragColor;

uniform sampler2D uTexture;

void main() {
  vec4 color = texture(uTexture, vUV);
  // è‡ªå®šä¹‰æ•ˆæœå¤„ç†
  fragColor = color;
}`;
  }
}

// ä½¿ç”¨è‡ªå®šä¹‰æ•ˆæœ
postProcess.addEffect(new CustomEffect(runner.device));
```

**æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š
1. **Ping-Pongä¼˜åŒ–**ï¼šManagerè‡ªåŠ¨ç®¡ç†2ä¸ªRenderTargetï¼Œé¿å…æ‰‹åŠ¨åˆ›å»º
2. **æ•ˆæœé¡ºåº**ï¼šå…ˆæ‰§è¡Œè®¡ç®—å¯†é›†å‹æ•ˆæœï¼ˆBlurï¼‰ï¼Œåæ‰§è¡Œè½»é‡çº§æ•ˆæœï¼ˆFXAAï¼‰
3. **æŒ‰éœ€å¯ç”¨**ï¼šä½¿ç”¨`effect.enabled`åŠ¨æ€æ§åˆ¶æ•ˆæœå¼€å…³
4. **åˆ†è¾¨ç‡æ§åˆ¶**ï¼šåå¤„ç†å¯ä½¿ç”¨ä½åˆ†è¾¨ç‡æ¸²æŸ“ï¼Œæœ€åupscaleåˆ°å±å¹•
5. **æ‰¹é‡å‚æ•°æ›´æ–°**ï¼šé¿å…æ¯å¸§è°ƒç”¨`setParameters()`

**é€‚ç”¨åœºæ™¯**ï¼š
- HDRæ¸²æŸ“ç®¡çº¿ï¼ˆToneMappingå¿…éœ€ï¼‰
- è§†è§‰å¢å¼ºï¼ˆäº®åº¦/å¯¹æ¯”åº¦/è‰²è°ƒè°ƒæ•´ï¼‰
- æŠ—é”¯é½¿ï¼ˆFXAAæ€§èƒ½ä¼˜äºMSAAï¼‰
- ç‰¹æ•ˆåˆæˆï¼ˆæ¨¡ç³Šã€è¾‰å…‰ã€æ™¯æ·±ï¼‰

### OrbitController (è½¨é“ç›¸æœº)

çƒé¢åæ ‡ç›¸æœºæ§åˆ¶ï¼š

- é¼ æ ‡å·¦é”®æ‹–åŠ¨ï¼šæ—‹è½¬è§†è§’
- é¼ æ ‡æ»šè½®ï¼šç¼©æ”¾
- é¼ æ ‡å³é”®/ä¸­é”®æ‹–åŠ¨ï¼šå¹³ç§»
- é˜»å°¼å¹³æ»‘è¿‡æ¸¡
- è‡ªåŠ¨æ—‹è½¬

```typescript
const orbit = new OrbitController(canvas, {
  distance: 5,
  target: [0, 0, 0],
  enableDamping: true,
});

runner.start((dt) => {
  orbit.update(dt);
  const viewMatrix = orbit.getViewMatrix();
  const projMatrix = orbit.getProjectionMatrix(aspect);
});
```

### SimpleGUI (GUI é¢æ¿)

é›¶ä¾èµ–çš„è½»é‡çº§ GUIï¼š

- æ•°å­—æ»‘å—
- å¸ƒå°”å¼€å…³
- é¢œè‰²é€‰æ‹©å™¨
- ä¸‹æ‹‰é€‰æ‹©

```typescript
const gui = new SimpleGUI();
gui.add('speed', { value: 1.0, min: 0, max: 5, onChange: (v) => {...} });
gui.add('enabled', { value: true, onChange: (v) => {...} });
gui.addSeparator('Section');
```

### Stats (æ€§èƒ½ç»Ÿè®¡)

å®æ—¶æ€§èƒ½é¢æ¿ï¼š

- FPS æ˜¾ç¤º
- å¸§æ—¶é—´ (ms)
- å†…å­˜ä½¿ç”¨ (å¯é€‰)

```typescript
const stats = new Stats({ position: 'top-left', show: ['fps', 'ms'] });
runner.start((dt) => {
  stats.begin();
  // æ¸²æŸ“ä»£ç 
  stats.end();
});
```

---

## å››ã€å·²å®Œæˆ Demo

| #   | åç§°             | æ–‡ä»¶                | åŠŸèƒ½ç‚¹                                        |
| --- | ---------------- | ------------------- | --------------------------------------------- | ------- |
| 01  | triangle         | triangle.ts         | æœ€å°åŒ–æ¸²æŸ“æµç¨‹ï¼ŒMVP çŸ©é˜µå˜æ¢åŸºç¡€å®ç°          |
| 02  | colored-triangle | colored-triangle.ts | é¡¶ç‚¹é¢œè‰²å±æ€§ï¼Œçº¢ç»¿è“æ¸å˜æ’å€¼æ•ˆæœ              |
| 03  | rotating-cube    | rotating-cube.ts    | 3Då˜æ¢ã€çº¹ç†ã€å…‰ç…§ã€GUIã€ç›¸æœºæ§åˆ¶             |
| 04  | quad-indexed     | quad-indexed.ts     | ç´¢å¼•ç¼“å†²åŒºç»˜åˆ¶ï¼Œé¡¶ç‚¹å¤ç”¨                      |
| 05  | primitive-types  | primitive-types.ts  | å›¾å…ƒæ‹“æ‰‘ç±»å‹ï¼ˆç‚¹/çº¿/ä¸‰è§’å½¢ï¼‰                  |
| 06  | viewport-scissor | viewport-scissor.ts | è§†å£å’Œè£å‰ªçŸ©å½¢ï¼Œå¤šè§†å£æ¸²æŸ“                    |
| 07  | depth-test       | depth-test.ts       | æ·±åº¦æµ‹è¯•åŠŸèƒ½ï¼Œå¤šä¸ªé‡å å‡ ä½•ä½“é®æŒ¡              |
| 08  | blend-modes      | blend-modes.ts      | å„ç§æ··åˆæ¨¡å¼ï¼Œæ”¯æŒçº¹ç†å’ŒMVPå˜æ¢               |
| 09  | multiple-buffers | multiple-buffers.ts | å¤šé¡¶ç‚¹ç¼“å†²åŒºï¼Œä½ç½®/é¢œè‰²/æ³•çº¿åˆ†ç¦»              |
| 10  | dynamic-buffer   | dynamic-buffer.ts   | ç¼“å†²åŒºåŠ¨æ€æ›´æ–°ï¼Œæ³¢æµªåŠ¨ç”»æ•ˆæœ                  |
| 11  | vertex-formats   | vertex-formats.ts   | é¡¶ç‚¹æ ¼å¼å¯¹æ¯”ï¼Œå†…å­˜ä¼˜åŒ–æ¼”ç¤º                    |
| 12  | stencil-test     | stencil-test.ts     | æ¨¡æ¿æµ‹è¯•ï¼Œè½®å»“æ•ˆæœï¼ˆOutlineï¼‰                 |
| 13  | texture-2d       | texture-2d.ts       | åŸºç¡€2Dçº¹ç†ï¼ŒTextureLoader + ProceduralTexture |
| 14  | texture-filtering | texture-filtering.ts | çº¹ç†è¿‡æ»¤æ¨¡å¼å¯¹æ¯”ï¼ˆNEAREST/LINEAR/å„å‘å¼‚æ€§ï¼‰ |
| 15  | texture-wrapping | texture-wrapping.ts | çº¹ç†åŒ…è£¹æ¨¡å¼ï¼ˆREPEAT/MIRROR_REPEAT/CLAMPï¼‰   |
| 16  | mipmaps          | mipmaps.ts          | Mipmap ç”Ÿæˆå’Œä½¿ç”¨ï¼ˆtextureLod + LOD æ§åˆ¶ï¼‰   | âœ… å®Œæˆ |
| 17  | multi-textures   | multi-textures.ts   | å¤šçº¹ç†ç»‘å®šå’Œ5ç§æ··åˆæ¨¡å¼ï¼ˆLinear/Multiplyç­‰ï¼‰ | âœ… å®Œæˆ |
| 18  | cubemap-skybox   | cubemap-skybox.ts   | ç«‹æ–¹ä½“è´´å›¾å¤©ç©ºç›’å’Œç¯å¢ƒæ˜ å°„                 | âœ… æ–°å¢ |
| 19  | render-to-texture| render-to-texture.ts| æ¸²æŸ“åˆ°çº¹ç†å’Œç¦»å±æ¸²æŸ“                      | âœ… æ–°å¢ |
| 20  | texture-array    | texture-array.ts    | çº¹ç†æ•°ç»„(TEXTURE_2D_ARRAY)æ¼”ç¤º            | âœ… æ–°å¢ |
| 21  | compressed-texture| compressed-texture.ts| å‹ç¼©çº¹ç†KTX/DDSåŠ è½½                     | âœ… æ–°å¢ |
| 22  | procedural-texture| procedural-texture.ts| ç¨‹åºåŒ–çº¹ç†ç”Ÿæˆï¼ˆå™ªå£°/åˆ†å½¢/æ³¢å½¢ï¼‰          | âœ… æ–°å¢ |

**æ³¨æ„**ï¼šæ‰€æœ‰ Demo å‡å·²é›†æˆ Stats æ€§èƒ½ç›‘æ§ã€OrbitController ç›¸æœºæ§åˆ¶å’Œå®Œæ•´çš„ MVP çŸ©é˜µå˜æ¢ç®¡çº¿ã€‚**ç¬¬ä¸€å±‚åŸºç¡€æ¸²æŸ“ 12 ä¸ª Demo å·²å…¨éƒ¨å®Œæˆï¼ˆ2025-12-10ï¼‰ã€‚ç¬¬äºŒå±‚çº¹ç†ç³»ç»Ÿ 10 ä¸ª Demo å·²å…¨éƒ¨å®Œæˆï¼ˆ2025-12-13ï¼‰ã€‚**

---

## äº”ã€Demo è§„åˆ’ (50 ä¸ª)

### ç¬¬ä¸€å±‚ï¼šåŸºç¡€æ¸²æŸ“ (12 demos)

| #   | åç§°             | éªŒè¯åŠŸèƒ½ç‚¹       | çŠ¶æ€    |
| --- | ---------------- | ---------------- | ------- |
| 01  | triangle         | æœ€å°åŒ–æ¸²æŸ“æµç¨‹   | âœ… å®Œæˆ |
| 02  | colored-triangle | é¡¶ç‚¹é¢œè‰²å±æ€§     | âœ… å®Œæˆ |
| 03  | quad-indexed     | ç´¢å¼•ç¼“å†²åŒºç»˜åˆ¶   | âœ… å®Œæˆ |
| 04  | rotating-cube    | 3D å˜æ¢çŸ©é˜µ      | âœ… å®Œæˆ |
| 05  | multiple-buffers | å¤šé¡¶ç‚¹ç¼“å†²åŒº     | âœ… å®Œæˆ |
| 06  | dynamic-buffer   | ç¼“å†²åŒºåŠ¨æ€æ›´æ–°   | âœ… å®Œæˆ |
| 07  | vertex-formats   | å„ç§é¡¶ç‚¹æ ¼å¼     | âœ… å®Œæˆ |
| 08  | primitive-types  | ç‚¹/çº¿/ä¸‰è§’å½¢æ‹“æ‰‘ | âœ… å®Œæˆ |
| 09  | viewport-scissor | è§†å£å’Œè£å‰ªçŸ©å½¢   | âœ… å®Œæˆ |
| 10  | depth-test       | æ·±åº¦æµ‹è¯•         | âœ… å®Œæˆ |
| 11  | stencil-test     | æ¨¡æ¿æµ‹è¯•         | âœ… å®Œæˆ |
| 12  | blend-modes      | æ··åˆæ¨¡å¼         | âœ… å®Œæˆ |

### ç¬¬äºŒå±‚ï¼šçº¹ç†ç³»ç»Ÿ (10 demos)

| #   | åç§°               | éªŒè¯åŠŸèƒ½ç‚¹         | çŠ¶æ€     |
| --- | ------------------ | ------------------ | -------- |
| 13  | texture-2d         | åŸºç¡€ 2D çº¹ç†é‡‡æ ·   | âœ… å®Œæˆ  |
| 14  | texture-wrapping   | é‡å¤/é•œåƒ/é’³åˆ¶æ¨¡å¼ | âœ… å®Œæˆ  |
| 15  | texture-filtering  | çº¿æ€§/æœ€è¿‘é‚»è¿‡æ»¤    | âœ… å®Œæˆ  |
| 16  | mipmaps            | Mipmap ç”Ÿæˆå’Œä½¿ç”¨  | âœ… å®Œæˆ  |
| 17  | multi-textures     | å¤šçº¹ç†æ··åˆ         | âœ… å®Œæˆ  |
| 18  | cubemap-skybox     | ç«‹æ–¹ä½“è´´å›¾å¤©ç©ºç›’   | âœ… å®Œæˆ  |
| 19  | render-to-texture  | æ¸²æŸ“åˆ°çº¹ç†         | âœ… å®Œæˆ  |
| 20  | texture-array      | çº¹ç†æ•°ç»„ (WebGL2)  | âœ… å®Œæˆ  |
| 21  | compressed-texture | å‹ç¼©çº¹ç†æ ¼å¼       | âœ… å®Œæˆ  |
| 22  | procedural-texture | ç¨‹åºåŒ–çº¹ç†ç”Ÿæˆ     | âœ… å®Œæˆ  |

### ç¬¬ä¸‰å±‚ï¼šå…‰ç…§ä¸æè´¨ (10 demos)

| #   | åç§°                | éªŒè¯åŠŸèƒ½ç‚¹       | çŠ¶æ€                 |
| --- | ------------------- | ---------------- | -------------------- |
| 23  | flat-shading        | å¹³é¢ç€è‰²         | âœ… å®Œæˆ              |
| 24  | gouraud-shading     | Gouraud ç€è‰²     | âœ… å®Œæˆ              |
| 25  | phong-lighting      | Phong å…‰ç…§æ¨¡å‹   | âœ… å®Œæˆ              |
| 26  | blinn-phong         | Blinn-Phong é«˜å…‰ | rotating-cube å·²æ¼”ç¤º |
| 27  | directional-light   | å¹³è¡Œå…‰æº         | âœ… å®Œæˆ              |
| 28  | point-lights        | å¤šç‚¹å…‰æº         | âœ… å®Œæˆ              |
| 29  | spotlight           | èšå…‰ç¯æ•ˆæœ       | âœ… å®Œæˆ              |
| 30  | normal-mapping      | æ³•çº¿è´´å›¾         | å¾…å®ç°               |
| 31  | environment-mapping | ç¯å¢ƒåå°„         | å¾…å®ç°               |
| 32  | pbr-material        | PBR æè´¨åŸºç¡€     | å¾…å®ç°               |

### ç¬¬å››å±‚ï¼šé«˜çº§æ¸²æŸ“ (10 demos)

| #   | åç§°                 | éªŒè¯åŠŸèƒ½ç‚¹          | çŠ¶æ€   |
| --- | -------------------- | ------------------- | ------ |
| 33  | instancing           | å®ä¾‹åŒ–æ¸²æŸ“          | å¾…å®ç° |
| 34  | indirect-draw        | é—´æ¥ç»˜åˆ¶            | å¾…å®ç° |
| 35  | multi-render-targets | MRT å¤šæ¸²æŸ“ç›®æ ‡      | å¾…å®ç° |
| 36  | shadow-mapping       | åŸºç¡€é˜´å½±è´´å›¾        | å¾…å®ç° |
| 37  | pcf-shadows          | PCF è½¯é˜´å½±          | å¾…å®ç° |
| 38  | post-process         | åå¤„ç†æ¡†æ¶          | å¾…å®ç° |
| 39  | bloom                | è¾‰å…‰æ•ˆæœ            | å¾…å®ç° |
| 40  | fxaa                 | FXAA æŠ—é”¯é½¿         | å¾…å®ç° |
| 41  | deferred-shading     | å»¶è¿Ÿç€è‰² (G-Buffer) | å¾…å®ç° |
| 42  | msaa                 | å¤šé‡é‡‡æ ·æŠ—é”¯é½¿      | å¾…å®ç° |

### ç¬¬äº”å±‚ï¼šæŸ¥è¯¢ä¸ä¼˜åŒ– (8 demos)

| #   | åç§°              | éªŒè¯åŠŸèƒ½ç‚¹         | çŠ¶æ€                 |
| --- | ----------------- | ------------------ | -------------------- |
| 43  | occlusion-query   | é®æŒ¡æŸ¥è¯¢           | å¾…å®ç°               |
| 44  | timestamp-query   | æ—¶é—´æˆ³æŸ¥è¯¢         | å¾…å®ç°               |
| 45  | push-constants    | Push Constants API | å¾…å®ç°               |
| 46  | uniform-buffer    | UBO ä½¿ç”¨           | rotating-cube å·²æ¼”ç¤º |
| 47  | resource-tracking | èµ„æºè¿½è¸ªæ¼”ç¤º       | å¾…å®ç°               |
| 48  | context-recovery  | ä¸Šä¸‹æ–‡ä¸¢å¤±æ¢å¤     | å¾…å®ç°               |
| 49  | performance-tips  | æ€§èƒ½ä¼˜åŒ–æŠ€å·§       | å¾…å®ç°               |
| 50  | stress-test       | å‹åŠ›æµ‹è¯•           | å¾…å®ç°               |

---

## å…­ã€Demo å¼€å‘è§„èŒƒ

### 1. å¿…éœ€ç»„ä»¶ï¼ˆè‡ª 2025-12-10 èµ·å¼ºåˆ¶ï¼‰

æ¯ä¸ª Demo **å¿…é¡»**åŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š

#### MVP çŸ©é˜µå˜æ¢ï¼ˆè‡ª 2025-12-10 èµ·æ–°å¢ï¼‰

æ‰€æœ‰ Demo å¿…é¡»å®ç°å®Œæ•´çš„ Model-View-Projection çŸ©é˜µå˜æ¢ç®¡çº¿ï¼š

```typescript
import { MMath } from '@maxellabs/core';

// 1. åˆ›å»ºæ¨¡å‹çŸ©é˜µ
const modelMatrix = new MMath.Matrix4();

// 2. åœ¨æ¸²æŸ“å¾ªç¯ä¸­æ›´æ–°å˜æ¢
runner.start((dt) => {
  orbit.update(dt);

  // è·å–è§†å›¾å’ŒæŠ•å½±çŸ©é˜µ
  const viewMatrix = orbit.getViewMatrix();
  const projMatrix = orbit.getProjectionMatrix(runner.width / runner.height);

  // 3. æ›´æ–° Uniform ç¼“å†²åŒº
  const transformData = new Float32Array(64);
  transformData.set(modelMatrix.toArray(), 0);
  transformData.set(viewMatrix, 16);
  transformData.set(projMatrix, 32);
  transformBuffer.update(transformData, 0);

  // æ¸²æŸ“ä»£ç ...
});
```

**ç€è‰²å™¨è¦æ±‚**ï¼š

```glsl
// å¿…é¡»åŒ…å« Transforms uniform å—
uniform Transforms {
  mat4 uModelMatrix;
  mat4 uViewMatrix;
  mat4 uProjectionMatrix;
};

// ä½¿ç”¨ MVP å˜æ¢
gl_Position = uProjectionMatrix * uViewMatrix * (uModelMatrix * vec4(aPosition, 1.0));
```

#### Stats æ€§èƒ½ç›‘æ§

```typescript
import { Stats } from './utils';

// åˆå§‹åŒ–
const stats = new Stats({ position: 'top-left', show: ['fps', 'ms'] });

// æ¸²æŸ“å¾ªç¯ä¸­
runner.start((dt) => {
  stats.begin();
  // æ¸²æŸ“ä»£ç ...
  stats.end();
});
```

#### OrbitController ç›¸æœºæ§åˆ¶

```typescript
import { OrbitController } from './utils';

// åˆå§‹åŒ–
const orbit = new OrbitController(runner.canvas, {
  distance: 3, // æ ¹æ®åœºæ™¯å¤§å°è°ƒæ•´
  target: [0, 0, 0],
  enableDamping: true,
  autoRotate: false,
  autoRotateSpeed: 0.5,
});

// æ¸²æŸ“å¾ªç¯ä¸­
runner.start((dt) => {
  orbit.update(dt);
  // è·å–çŸ©é˜µ
  const viewMatrix = orbit.getViewMatrix();
  const projMatrix = orbit.getProjectionMatrix(aspect);
});

// é€€å‡ºæ—¶é”€æ¯
runner.onKey('Escape', () => {
  stats.destroy();
  orbit.destroy();
  runner.destroy();
});
```

### 2. UI å¸ƒå±€è§„èŒƒ

#### å·¦ä¸Šè§’ï¼šStats æ€§èƒ½ç›‘æ§

- ç”± Stats ç»„ä»¶è‡ªåŠ¨æ¸²æŸ“
- ä½ç½®ï¼š`position: 'top-left'`
- æ˜¾ç¤º FPS å’Œå¸§æ—¶é—´

#### å·¦ä¸‹è§’ï¼šDemo ä»‹ç»é¢æ¿

**âš ï¸ é‡è¦**: ä»‹ç»é¢æ¿å¿…é¡»ä½äºå·¦ä¸‹è§’ï¼Œä¸èƒ½æ”¾åœ¨å…¶ä»–ä½ç½®ã€‚

```css
.info-panel {
  position: absolute;
  bottom: 20px;
  left: 20px;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 15px 20px;
  border-radius: 8px;
  font-size: 13px;
  max-width: 320px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.15);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}
```

#### Canvas å®¹å™¨å¸ƒå±€ï¼ˆå¿…éœ€ï¼‰

**âš ï¸ é‡è¦**: Canvas å¿…é¡»ä½¿ç”¨ `.container` å®¹å™¨åŒ…è£¹ï¼Œ**ä¸èƒ½**ç›´æ¥å¯¹ Canvas è®¾ç½® `width: 100%; height: 100%` çš„ CSS æ ·å¼ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¸²æŸ“é»‘å±ã€‚

æ­£ç¡®çš„ HTML ç»“æ„ï¼š

```html
<body>
  <div class="container">
    <canvas id="J-canvas"></canvas>
  </div>
  <div class="info-panel">...</div>
</body>
```

æ­£ç¡®çš„ CSS æ ·å¼ï¼š

```css
body {
  margin: 0;
  padding: 0;
  overflow: hidden;
}

.container {
  width: 100vw;
  height: 100vh;
  background-color: #000;
  display: flex;
  justify-content: center;
  align-items: center;
}

#J-canvas {
  display: block;
  cursor: grab;
}

#J-canvas:active {
  cursor: grabbing;
}
```

**é”™è¯¯ç¤ºä¾‹ï¼ˆä¼šå¯¼è‡´é»‘å±ï¼‰**ï¼š

```css
/* âŒ é”™è¯¯ï¼šä¸è¦ç›´æ¥å¯¹ Canvas è®¾ç½® 100% å°ºå¯¸ */
#J-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
```

åŸå› ï¼šDemoRunner é€šè¿‡ `window.innerWidth/Height` åŠ¨æ€è®¾ç½® Canvas çš„å®é™…æ¸²æŸ“å°ºå¯¸ï¼ˆ`canvas.width/height` å±æ€§ï¼‰ï¼Œè€Œ CSS çš„ `width: 100%` ä¼šåˆ›å»ºä¸€ä¸ªä¸å®é™…æ¸²æŸ“bufferå°ºå¯¸ä¸åŒ¹é…çš„æ˜¾ç¤ºå°ºå¯¸ï¼Œå¯¼è‡´æ¸²æŸ“å†…å®¹ä¸å¯è§ã€‚

#### ä»‹ç»é¢æ¿ HTML ç»“æ„

```html
<div class="info-panel">
  <h3>ğŸ”º Demo åç§°</h3>
  <p class="description">ç®€æ´çš„ Demo æè¿°...</p>
  <div class="tech-points">
    <h4>ğŸ’¡ æŠ€æœ¯è¦ç‚¹</h4>
    <ul>
      <li>æŠ€æœ¯ç‚¹ 1</li>
      <li>æŠ€æœ¯ç‚¹ 2</li>
      <li>æŠ€æœ¯ç‚¹ 3</li>
    </ul>
  </div>
</div>
```

### 3. æ¸²æŸ“å¾ªç¯è§„èŒƒ

```typescript
runner.start((dt) => {
  // 1. æ›´æ–°çŠ¶æ€
  orbit.update(dt);

  // 2. å¼€å§‹æ€§èƒ½ç»Ÿè®¡
  stats.begin();

  // 3. æ¸²æŸ“ä»£ç 
  const { encoder, passDescriptor } = runner.beginFrame();
  // ... æ¸²æŸ“é€»è¾‘ ...
  runner.endFrame(encoder);

  // 4. ç»“æŸæ€§èƒ½ç»Ÿè®¡
  stats.end();
});
```

### 4. å¸®åŠ©ä¿¡æ¯è§„èŒƒ

å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

- ESCï¼šé€€å‡º Demo
- F11ï¼šåˆ‡æ¢å…¨å±
- é¼ æ ‡æ§åˆ¶è¯´æ˜

```typescript
DemoRunner.showHelp([
  'ESC: é€€å‡º Demo',
  'F11: åˆ‡æ¢å…¨å±',
  'é¼ æ ‡å·¦é”®æ‹–åŠ¨: æ—‹è½¬è§†è§’',
  'é¼ æ ‡æ»šè½®: ç¼©æ”¾',
  'é¼ æ ‡å³é”®æ‹–åŠ¨: å¹³ç§»',
]);
```

### 5. å¯¼å…¥è§„èŒƒ

```typescript
import { MSpec } from '@maxellabs/core';
import {
  DemoRunner,
  GeometryGenerator,
  OrbitController, // å¿…éœ€
  Stats, // å¿…éœ€
} from './utils';
```

### 6. åœ¨ index.html ä¸­æ³¨å†Œ Demo å…¥å£

æ‰€æœ‰ RHI Demo **å¿…é¡»**åœ¨ `packages/rhi/demo/index.html` ä¸­æ³¨å†Œå…¥å£ï¼Œç¡®ä¿å¯ä»¥ä» Demo Gallery é¦–é¡µç›´æ¥è®¿é—®ã€‚

#### 6.1 å…¥å£å¡ç‰‡ç»“æ„è¦æ±‚

- æ¯ä¸ª Demo å¯¹åº”ä¸€ä¸ª `.demo-card` å¡ç‰‡
- æŒ‰åˆ†ç±»ï¼ˆåŸºç¡€åŠŸèƒ½ / çº¹ç†ç³»ç»Ÿ / é«˜çº§æ¸²æŸ“ç­‰ï¼‰å½’å…¥å¯¹åº”çš„ `category` åŒºå—
- å¡ç‰‡å†…éƒ¨åŒ…å«ï¼š
  - æ ‡é¢˜è¡Œï¼šEmoji + Demo åç§° + éš¾åº¦æ ‡ç­¾
  - ä¸€æ®µç®€çŸ­æè¿°ï¼ˆ1~3 å¥è¯ï¼‰
  - æŠ€æœ¯è¦ç‚¹æ ‡ç­¾åˆ—è¡¨ `.tech-tags`
  - è¿è¡Œå…¥å£é“¾æ¥ `.demo-link`

ç¤ºä¾‹ï¼ˆçº¹ç†ç³»ç»Ÿ Demo å¡ç‰‡ï¼‰ï¼š

```html
<!-- çº¹ç†ç³»ç»ŸDemo -->
<div class="category">
  <h2>ğŸ–¼ï¸ çº¹ç†ç³»ç»ŸDemo</h2>
</div>

<div class="demo-card">
  <h3>ğŸ¨ åŸºç¡€ 2D çº¹ç† <span class="difficulty intermediate">ä¸­çº§</span></h3>
  <p>
    æ¼”ç¤ºçº¹ç†åŠ è½½å’Œé‡‡æ ·çš„åŸºç¡€åŠŸèƒ½ã€‚å±•ç¤º TextureLoader åŠ è½½å¤–éƒ¨å›¾ç‰‡ã€ProceduralTexture
    ç”Ÿæˆç¨‹åºåŒ–çº¹ç†ï¼Œä»¥åŠå¤šçº¹ç†å¯¹æ¯”æ˜¾ç¤ºã€‚
  </p>
  <div class="tech-tags">
    <span class="tech-tag">TextureLoader</span>
    <span class="tech-tag">sampler2D</span>
    <span class="tech-tag">UVæ˜ å°„</span>
    <span class="tech-tag">ç¨‹åºåŒ–çº¹ç†</span>
  </div>
  <a class="demo-link" href="html/texture-2d.html">ğŸ® è¿è¡ŒDemo</a>
</div>
```

#### 6.2 å…¥å£é“¾æ¥è·¯å¾„è§„èŒƒ

- æ‰€æœ‰ Demo çš„è¿è¡Œé¡µé¢å¿…é¡»æ”¾åœ¨ï¼š`packages/rhi/demo/html/` ç›®å½•ä¸‹
- å…¥å£é“¾æ¥ç»Ÿä¸€ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼š
  - `href="html/<demo-name>.html"`
  - ä¾‹å¦‚ï¼š
    - `triangle` â†’ `html/triangle.html`
    - `texture-2d` â†’ `html/texture-2d.html`
    - `texture-wrapping` â†’ `html/texture-wrapping.html`
- ä¸å…è®¸ç›´æ¥é“¾æ¥åˆ° `.ts` æºç æ–‡ä»¶

#### 6.3 æ·»åŠ æ–° Demo çš„æ ‡å‡†æµç¨‹

å½“ä½ å®Œæˆä¸€ä¸ªæ–°çš„ Demoï¼ˆä¾‹å¦‚ `texture-wrapping`ï¼‰æ—¶ï¼Œå¿…é¡»æŒ‰ä»¥ä¸‹é¡ºåºå®Œæˆæ³¨å†Œï¼š

1. åœ¨ `packages/rhi/demo/html/` ä¸‹åˆ›å»ºå¯¹åº”çš„ HTML é¡µé¢ï¼ˆä¾‹å¦‚ `texture-wrapping.html`ï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­ï¼š
   - åˆ›å»º `<canvas id="J-canvas"></canvas>` ä½œä¸ºæ¸²æŸ“å®¹å™¨
   - ä½¿ç”¨ `<script type="module">` å¼•å…¥å¯¹åº”çš„ TypeScript æ¨¡å—ï¼Œä¾‹å¦‚ï¼š

```html
<script type="module">
  async function init() {
    await import('../src/texture-wrapping.ts');
  }

  init();
</script>
```

2. æ‰“å¼€ `packages/rhi/demo/index.html`ï¼Œåœ¨åˆé€‚çš„åˆ†ç±»ä¸‹æ·»åŠ æ–°çš„ `.demo-card`ï¼š

   - çº¹ç†ç›¸å…³ Demo æ”¾åœ¨ã€ŒğŸ–¼ï¸ çº¹ç†ç³»ç»ŸDemoã€åˆ†ç±»å†…
   - åŸºç¡€æ¸²æŸ“ Demo æ”¾åœ¨ã€ŒğŸ¯ åŸºç¡€åŠŸèƒ½Demoã€åˆ†ç±»å†…
   - é«˜çº§æ¸²æŸ“ / æŸ¥è¯¢ä¼˜åŒ– Demo æŒ‰è§„åˆ’è¡¨é€‰æ‹©å¯¹åº”åˆ†ç»„

3. ä¿æŒæ ‡é¢˜å’Œæè¿°é£æ ¼ä¸ç°æœ‰å¡ç‰‡ä¸€è‡´ï¼š
   - æ ‡é¢˜ä½¿ç”¨ Emoji å‰ç¼€ï¼Œä¾‹å¦‚ `ğŸ” çº¹ç†åŒ…è£¹æ¨¡å¼`
   - éš¾åº¦æ ‡ç­¾ä½¿ç”¨ç°æœ‰çš„ `difficulty beginner` / `difficulty intermediate` / `difficulty advanced` ç±»
   - æŠ€æœ¯è¦ç‚¹æ ‡ç­¾ç®€æ´æ¦‚æ‹¬ä¸»è¦ API æˆ–æ¦‚å¿µ

#### 6.4 éªŒè¯æ­¥éª¤ä¸é¢„æœŸç»“æœ

å®Œæˆå…¥å£æ³¨å†Œåï¼Œå¿…é¡»æŒ‰ä»¥ä¸‹æ­¥éª¤è‡ªæ£€ï¼š

1. åœ¨ä»“åº“æ ¹ç›®å½•å¯åŠ¨ RHI Demo å¼€å‘æœåŠ¡å™¨ï¼š

```bash
pnpm --filter @maxellabs/rhi dev
```

2. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é¦–é¡µï¼š

```text
http://<æœ¬æœºæˆ–å±€åŸŸç½‘IP>:3001/demo/index.html
```

3. åœ¨é¡µé¢ä¸­æ‰¾åˆ°æ–°æ·»åŠ çš„ Demo å¡ç‰‡ï¼Œæ£€æŸ¥ï¼š

   - å¡ç‰‡æ ·å¼ä¸å…¶ä»– Demo ä¸€è‡´
   - æè¿°å’ŒæŠ€æœ¯æ ‡ç­¾æ˜¾ç¤ºæ­£å¸¸ï¼Œæ²¡æœ‰æ’ç‰ˆé”™ä¹±

4. ç‚¹å‡»ã€ŒğŸ® è¿è¡ŒDemoã€ï¼š
   - æµè§ˆå™¨è·³è½¬åˆ°å¯¹åº”çš„ `html/<demo-name>.html` é¡µé¢
   - åŠ è½½è¿‡ç¨‹ä¸­æ—  404 / 500 ç­‰èµ„æºé”™è¯¯ï¼ˆåœ¨ DevTools Network é¢æ¿ä¸­ç¡®è®¤ï¼‰
   - Demo è‡ªåŠ¨åˆå§‹åŒ–å¹¶å¼€å§‹æ¸²æŸ“ï¼ˆæ§åˆ¶å°è¾“å‡ºåˆå§‹åŒ–æ—¥å¿—ï¼‰
   - æ‰€æœ‰é”®ç›˜/é¼ æ ‡äº¤äº’æŒ‰å„è‡ª Demo æ–‡æ¡£è¯´æ˜æ­£å¸¸å·¥ä½œ

#### 6.5 å¸¸è§é—®é¢˜ä¸æ’æŸ¥å»ºè®®

- **é—®é¢˜ï¼šç‚¹å‡»é¦–é¡µå¡ç‰‡åå‡ºç° 404 é¡µé¢**

  - æ£€æŸ¥ `href` æ˜¯å¦æŒ‡å‘æ­£ç¡®çš„ `html/<demo-name>.html`
  - ç¡®è®¤å¯¹åº” HTML æ–‡ä»¶å·²ç»å­˜åœ¨äº `packages/rhi/demo/html/` ç›®å½•ä¸­

- **é—®é¢˜ï¼šé¡µé¢æ‰“å¼€ä½†ç”»é¢ä¸€ç‰‡é»‘ / æ²¡æœ‰æ¸²æŸ“**

  - **é¦–å…ˆæ£€æŸ¥ Canvas å¸ƒå±€**ï¼šç¡®è®¤ HTML ä¸­ä½¿ç”¨äº† `.container` å®¹å™¨åŒ…è£¹ Canvasï¼Œè€Œä¸æ˜¯ç›´æ¥å¯¹ Canvas è®¾ç½® `width: 100%; height: 100%` çš„ CSS æ ·å¼ï¼ˆè¿™æ˜¯æœ€å¸¸è§çš„é»‘å±åŸå› ï¼‰
  - ç¡®è®¤ HTML ä¸­çš„ `canvas` å…ƒç´  id æ˜¯å¦ä¸ DemoRunner é…ç½®ä¸€è‡´ï¼ˆé€šå¸¸æ˜¯ `J-canvas`ï¼‰
  - æ£€æŸ¥ `<script type="module">` ä¸­çš„ `import` è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆ`../src/<demo-name>.ts`ï¼‰
  - åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ˜¯å¦æœ‰ WebGL åˆå§‹åŒ–é”™è¯¯æˆ–æœªæ•è·å¼‚å¸¸

- **é—®é¢˜ï¼šé¦–é¡µèƒ½çœ‹åˆ°å¡ç‰‡ï¼Œä½†æ ·å¼é”™ä¹±**

  - ç¡®è®¤æ–°å¡ç‰‡çš„ HTML ç»“æ„ä¸ç¤ºä¾‹ä¿æŒä¸€è‡´ï¼ˆ`demo-card`ã€`tech-tags`ã€`demo-link` ç­‰ç±»åä¸è¦ä¿®æ”¹ï¼‰
  - é¿å…åœ¨å¡ç‰‡å†…éƒ¨å¼•å…¥é¢å¤–çš„å¸ƒå±€å®¹å™¨ç ´åç°æœ‰ CSS ç½‘æ ¼ç»“æ„

- **é—®é¢˜ï¼šæ–°å¢ Demo æ²¡æœ‰å‡ºç°åœ¨é¦–é¡µ**
  - ç¡®è®¤ä¿®æ”¹çš„æ˜¯ `packages/rhi/demo/index.html` è€Œä¸æ˜¯å…¶ä»–åŒåæ–‡ä»¶
  - ä½¿ç”¨æµè§ˆå™¨å¼ºåˆ¶åˆ·æ–°ï¼ˆå»ºè®®å¼€å¯ DevTools å¹¶å‹¾é€‰ã€ŒDisable cacheã€ï¼‰

---

## ä¸ƒã€ç›¸å…³æ–‡æ¡£

- [RHI æ¦‚è§ˆ](/llmdoc/overview/rhi-overview.md)
- [WebGL å®ç°æ¶æ„](/llmdoc/architecture/webgl-implementation.md)
- [èµ„æºè¿½è¸ª API](/llmdoc/reference/resource-tracker-api.md)
- [ä¸Šä¸‹æ–‡ä¸¢å¤±å¤„ç†](/llmdoc/guides/handle-context-loss.md)
